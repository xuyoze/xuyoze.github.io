
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="ç¨‹åºå‘˜çš„åšå®¢">
    <title>ç»ƒä¹ ä½¿ç”¨scrapyæ¡†æ¶æŠ“å–å›¾è™«å›¾ç‰‡ - ç¨‹åºå‘˜çš„åšå®¢</title>
    <meta name="author" content="Yoze">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Yoze","sameAs":["https://github.com/xuyoze"],"image":"avator.png"},"articleBody":"å…ƒæ—¦å‡æœŸï¼Œå¤©å¹²ç‰©ç‡¥ï¼Œå¯’é£åˆºéª¨ï¼Œä¸å®œå¤–å‡ºã€‚é»„å†ä¸Šå¥½åƒæ˜¯è¿™ä¹ˆè¯´çš„ï¼Œå—¯ï¼Œ å‡†æ²¡é”™ã€‚\næ‰€ä»¥åœ¨å®¶ä¸‰å¤©ä¸å‡ºå±‹ã€‚ã€‚ã€‚ã€‚\nä»¥ä¸Šéƒ½æ˜¯å€Ÿå£ï¼Œå…¶å®å°±æ˜¯æ‡’ï¼Œå°±æ˜¯å®…\næ•´å¥½åœ¨ç†Ÿæ‚‰ä¸€æŠŠPythonçš„çˆ¬è™«æ¡†æ¶scrapyã€‚è¿™ç¯‡æ–‡ç« ä¸æ˜¯æ•™ç¨‹ï¼Œ åªæ˜¯æˆ‘åœ¨ç»ƒä¹ è¿‡ç¨‹ä¸­å‡ºç°çš„ä¸€äº›é—®é¢˜çš„è®°å½•ï¼Œ å¦‚æœä½ æƒ³å­¦ä¹ scrayæ¡†æ¶çš„è¯,è¯·ç§»æ­¥å…¶ä»–ç½‘ç«™æ–‡ç« .æˆ–è€…ç›´æ¥æŸ¥çœ‹scrapyå®˜æ–¹æ–‡æ¡£.\n\nçˆ¬å–å‰å‡†å¤‡å›¾è™«çš„ç›¸å…³å›¾ç‰‡éƒ½æ˜¯æŒ‰ç…§Tagçš„æ–¹å¼è¿›è¡Œç»„ç»‡çš„, æ‰€ä»¥æˆ‘ä»¬å¾ˆå®¹æ˜“å°±å¯ä»¥æ ¹æ®æ ‡ç­¾è¿›è¡ŒæŸç±»å›¾ç‰‡çš„çˆ¬å–ã€‚ä¸‹é¢æ˜¯å›¾è™«çš„å…¥å£é¡µé¢å›¾è™«å…¥å£\nçˆ¬å»å…¥å£æ¯ä¸ªæ ‡ç­¾æˆ–ä¸“é¢˜é¡µé¢é‡‡ç”¨çš„æ˜¯JSåŠ¨æ€ç¿»é¡µ,æˆ‘ä»¬å¯ä»¥é€šè¿‡WEBå·¥å…·çš„ç½‘ç»œåŠŸèƒ½,æˆ–è€…fidderæŸ¥çœ‹å¯¹åº”çš„è¯·æ±‚.è·å¾—å¦‚ä¸‹æ¥å£è¯·æ±‚åœ°å€:https://tuchong.com/rest/tags/%E8%87%AA%E7%84%B6/posts?page=1&amp;count=20&amp;type=hot\nå¯ä»¥çœ‹åˆ°, æœ‰å‡ ä¸ªå¯ç”¨çš„å‚æ•°:\n\ntags\npage\ncount\ntype\n\nç”±æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°åˆ†é¡µçš„æ¥å£æ•°æ®å¦‚ä¸‹å›¾æ‰€ç¤ºè¿™ä¸ªæ˜¯åˆ—è¡¨é¡µçš„åŸºæœ¬æ•°æ®ä¿¡æ¯\nè¿”å›çš„JSONæ•°æ®ä¸­æ¯ä¸ªpostèŠ‚ç‚¹ä¸‹éƒ½æœ‰ä¸€ä¸ªimagesæ•°ç»„,å¦‚æœæ•°ç»„ä¸­æœ‰å¯¹ä¸ªå€¼è¡¨ç¤º,è¿™ä¸ªæ˜¯ä¸€ç»„å¥—å›¾.å› æ­¤æˆ‘ä»¬å¯ä»¥æ ¹æ® images èŠ‚ç‚¹,å¾ªç¯å¹¶è·å–ç›¸åº”çš„å¥—å›¾ã€‚\nåŸå›¾åœ°å€åˆ†æç”±äºåˆ—è¡¨é¡µæ˜¯ç¼©æ”¾åçš„å›¾ç‰‡, æ‰€ä»¥æˆ‘ä»¬åªèƒ½æ‰‹åŠ¨æŸ¥çœ‹å¹¶å½’çº³åŸå›¾æ–‡ä»¶çš„è·¯å¾„è§„åˆ™.ä¹Ÿè®¸å“ªä¸€å¤©è§„åˆ™å°±å˜äº†ä¹Ÿè¯´ä¸ä¸Šä½†æ˜¯ç›®å‰è¿˜æ˜¯å¯ç”¨çš„ã€‚\nè§„åˆ™å¦‚ä¸‹ï¼š\n\nç¼©ç•¥å›¾è§„åˆ™ :https://photo.tuchong.com/+ author_id + /g/ + img_id +.jpg  å¦‚:https://photo.tuchong.com/1370833/g/20494979.jpgauthor_id æ˜¯å›¾ç‰‡ä½œè€…çš„ç¼–å·,img_id æ˜¯å›¾ç‰‡ç¼–å·\n\nåŸå›¾è§„åˆ™ :https://photo.tuchong.com/+ author_id + /f/ + img_id +.jpg  å¦‚:https://photo.tuchong.com/1370833/f/20494979.jpgauthor_id æ˜¯å›¾ç‰‡ä½œè€…çš„ç¼–å·,img_id æ˜¯å›¾ç‰‡ç¼–å·\n\n\nä»£ç ç¼–å†™åˆ›å»ºçˆ¬è™«# åˆ›å»ºé¡¹ç›®scrapy startproject TuchongProj# è¿›å…¥é¡¹ç›®cd TuchongProj# åˆ›å»ºçˆ¬è™«scrapy genspider tuchong tuchong.com\nç›¸å…³ä»£ç ç¼–å†™tuchong.py æ¼”ç¤ºä»£ç , ä»£ç æœªå®ç°ç¿»é¡µ,åªå–äº†ä¸€é¡µæ•°æ®ã€‚\nclass TuchongSpider(scrapy.Spider):    name = 'tuchong'    allowed_domains = ['tuchong.com']    # è¯·æ±‚URLæ„é€ å‚æ•°    tag = \"é£å…‰\"    types = \"hot\"  # new    order = \"weekly\"    page = \"1\"    count = \"20\"    baseUrl = \"https://tuchong.com/rest/tags/\"    start_urls = [baseUrl + tag + \"/posts?page=\" +                  page + \"&amp;count=\" + count + \"&amp;order=\" + order]    # æš‚æ—¶æœªåšåˆ†é¡µåŠŸèƒ½(å¾ªç¯page)    def parse(self, response):        posts = json.loads(response.body)['postList']        for post in posts:            images = post['images']            for img in images:                item = TuchongprojItem()                author_id = img['user_id']                img_id = img['img_id']                img_link = \"https://photo.tuchong.com/\" + \\                    str(author_id) + \"/f/\" + str(img_id) + \".jpg\"                item['authorId'] = author_id                item['imageId'] = img_id                item['imageLink'] = img_link                yield item\næˆ‘åœ¨å®šä¹‰çš„Itemæœ‰ä¸‰ä¸ªå­—æ®µï¼Œ è¿™é‡Œåªå–äº†æ¥å£JSONæ•°æ®ä¸­çš„author_idå’Œimg_id æŒ‰ç…§ä¸Šé¢çš„åˆ†æçš„è§„åˆ™,æ‹¼è£…äº†å›¾ç‰‡çš„å¤§å›¾è·¯å¾„ã€‚\nItemå®šä¹‰ï¼šclass TuchongprojItem(scrapy.Item):    # define the fields for your item here like:    authorId = scrapy.Field()    imageId = scrapy.Field()    imageLink = scrapy.Field()\næ¥ä¸‹æ¥å°±æ˜¯å®šä¹‰pipelineå¤„ç†ç›¸å…³æ•°æ®äº†class TuchongprojPipeline(ImagesPipeline):    def get_media_requests(self, item, info):        imglink = item['imageLink']        # print(imglink)        yield scrapy.Request(imglink)    def item_completed(self, result, item, info):        # print(result)        # [(True, &#123;'url': 'https://photo.tuchong.com/1660246/f/9281459.jpg', 'path': 'full/e8876e7547c166d58876c3fce547d6819d8bf031.jpg', 'checksum': 'd78e6ba1115ae956878bdc630173ea7a'&#125;)]        # å–å‡ºå›¾ç‰‡å­˜æ”¾çš„åœ°å€        author_id = item['authorId']        img_id = item['imageId']        patharr = [x[\"path\"] for ok, x in result if ok]        path = patharr[0]        # æ–‡ä»¶é‡å‘½å(åŸåœ°å€,æ–°åœ°å€)        os.rename(images_store + path, images_store + \"full/\" +                  str(author_id) + \"-\" + str(img_id) + \".jpg\")        return item\nç”±äºè¦å¤„ç†å›¾ç‰‡æ•°æ®,æˆ‘ä»¬ä½¿ç”¨scrapyæä¾›ImagesPipelineè¿›è¡Œå›¾ç‰‡å¤„ç†.é‡å†™ImagesPipelineé‡Œçš„ä¸¤ä¸ªæ–¹æ³•:get_media_requestsæ–¹æ³•, ä¸»è¦è´Ÿè´£å‘é€å›¾ç‰‡è·å–è¯·æ±‚, è¿™é‡Œæˆ‘ä»¬å°†æˆ‘ä»¬æ‹¼è£…çš„å›¾ç‰‡å¤§å›¾åœ°å€ä¼ é€’ç»™Requestè¿›è¡Œå›¾ç‰‡å¤„ç†.\nitem_completedæ–¹æ³•, è¿™é‡Œä¸»è¦ç”¨æ¥å¯¹ä¸‹è½½å›æ¥çš„å›¾ç‰‡è¿›è¡Œé‡å‘½åå¤„ç†. æˆ‘ä»¬çš„å‘½åè§„åˆ™æ˜¯ author_id+&#39;-&#39;+img_id, è¿™æ ·ä¾¿äºæˆ‘ä»¬è¿›è¡Œæ’åº ^_^\nä½¿ç”¨ImagesPipeline æˆ‘ä»¬éœ€è¦åˆ¶å®šå›¾ç‰‡çš„å­˜æ”¾åœ°å€,åŒæ—¶æˆ‘ä»¬éœ€è¦å¯ç”¨å½“å‰pipeline\nsettings.py# Configure item pipelines# See http://scrapy.readthedocs.org/en/latest/topics/item-pipeline.htmlITEM_PIPELINES = &#123;    &apos;TuchongProj.pipelines.TuchongprojPipeline&apos;: 300,&#125;# çˆ¬å–å›¾ç‰‡åå›¾ç‰‡å­˜æ”¾çš„ä½ç½®IMAGES_STORE = &quot;F:/_tuchong/fengjing/&quot;\nå¥½äº†, çˆ¬è™«å·®ä¸å¤šäº†,è¿è¡Œä¸‹è¯•è¯•å§!\nscrapy crawl tuchong\nç›¸å…³é—®é¢˜æ¥å£è¯·æ±‚ä¸æˆåŠŸæˆ–è¿”å›çš„æ•°æ®ä¸ºç©º\nUserAgenté—®é¢˜.è‡ªå®šä¹‰UserAgent,åœ¨settings.pyä¿®æ”¹UA\n# Crawl responsibly by identifying yourself (and your website) on the user-agentUSER_AGENT = &apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3294.6 Safari/537.36&apos;\n\nè¯·æ±‚è¿‡å¿«,ç›¸åº”ä¸è¿‡æ¥é™åˆ¶å¹¶å‘æ•°,å¢åŠ å»¶è¿Ÿæ—¶é—´\n# Configure maximum concurrent requests performed by Scrapy (default: 16)CONCURRENT_REQUESTS = 1# Configure a delay for requests for the same website (default: 0)# See http://scrapy.readthedocs.org/en/latest/topics/settings.html#download-delay# See also autothrottle settings and docsDOWNLOAD_DELAY = 5\n\n\næœ¬æœºæ²¡æœ‰å›¾ç‰‡å¤„ç†ç›¸å…³åº“No module named â€˜PILâ€™\n\nå®‰è£…Pillowåº“pip install pillow\npillowåŸºæœ¬çŸ¥è¯†\nå…¶ä»–è‡ªå·±å†™çˆ¬è™«,çº¯ç²¹å°±æ˜¯ç©ç¥¨ã€‚æˆ‘ä»¬è‡ªå·±å†™çˆ¬è™«ï¼Œå»çˆ¬å–åˆ«äººçš„æ•°æ®ï¼Œ å°½é‡å°†å¹¶å‘é™ä½ï¼Œä¸è¦ç»™ç«™ç‚¹é€ æˆéªšæ‰°ã€‚å¦‚æœå¯ä»¥å°½é‡æŒ‰ç…§çˆ¬è™«åè®®æ¥çˆ¬å–åº”å…çš„å†…å®¹ã€‚\né™„ å›¾è™«çš„çˆ¬è™«åè®®# Robots.txt file from http://www.tuchong.com# All robots will spider the domainUser-agent: YandexBotDisallow: /User-agent: MJ12botDisallow: /User-agent: PurebotDisallow: /User-agent: psbotDisallow: /User-agent: *Disallow: /admin/Disallow: /api/\n\n ç›¸å…³å­¦ä¹ èµ„æ–™\n\nscrapyæ–‡æ¡£(CN)\n\n\n","dateCreated":"2018-01-01T21:14:58+08:00","dateModified":"2018-01-04T17:05:52+08:00","datePublished":"2018-01-01T21:14:58+08:00","description":"å…ƒæ—¦å‡æœŸï¼Œå¤©å¹²ç‰©ç‡¥ï¼Œå¯’é£åˆºéª¨ï¼Œä¸å®œå¤–å‡ºã€‚é»„å†ä¸Šå¥½åƒæ˜¯è¿™ä¹ˆè¯´çš„ï¼Œå—¯ï¼Œ å‡†æ²¡é”™ã€‚\næ‰€ä»¥åœ¨å®¶ä¸‰å¤©ä¸å‡ºå±‹ã€‚ã€‚ã€‚ã€‚\nä»¥ä¸Šéƒ½æ˜¯å€Ÿå£ï¼Œå…¶å®å°±æ˜¯æ‡’ï¼Œå°±æ˜¯å®…\næ•´å¥½åœ¨ç†Ÿæ‚‰ä¸€æŠŠPythonçš„çˆ¬è™«æ¡†æ¶scrapyã€‚è¿™ç¯‡æ–‡ç« ä¸æ˜¯æ•™ç¨‹ï¼Œ åªæ˜¯æˆ‘åœ¨ç»ƒä¹ è¿‡ç¨‹ä¸­å‡ºç°çš„ä¸€äº›é—®é¢˜çš„è®°å½•ï¼Œ å¦‚æœä½ æƒ³å­¦ä¹ scrayæ¡†æ¶çš„è¯,è¯·ç§»æ­¥å…¶ä»–ç½‘ç«™æ–‡ç« .æˆ–è€…ç›´æ¥æŸ¥çœ‹scrapyå®˜æ–¹æ–‡æ¡£.","headline":"ç»ƒä¹ ä½¿ç”¨scrapyæ¡†æ¶æŠ“å–å›¾è™«å›¾ç‰‡","image":["32615134.jpg"],"mainEntityOfPage":{"@type":"WebPage","@id":"http://xuyoze.github.io/2018/01/01/using-scrapy/"},"publisher":{"@type":"Organization","name":"Yoze","sameAs":["https://github.com/xuyoze"],"image":"avator.png","logo":{"@type":"ImageObject","url":"avator.png"}},"url":"http://xuyoze.github.io/2018/01/01/using-scrapy/","keywords":"python, scrapy","thumbnailUrl":"32615134.jpg"}</script>
    <meta name="description" content="å…ƒæ—¦å‡æœŸï¼Œå¤©å¹²ç‰©ç‡¥ï¼Œå¯’é£åˆºéª¨ï¼Œä¸å®œå¤–å‡ºã€‚é»„å†ä¸Šå¥½åƒæ˜¯è¿™ä¹ˆè¯´çš„ï¼Œå—¯ï¼Œ å‡†æ²¡é”™ã€‚ æ‰€ä»¥åœ¨å®¶ä¸‰å¤©ä¸å‡ºå±‹ã€‚ã€‚ã€‚ã€‚ ä»¥ä¸Šéƒ½æ˜¯å€Ÿå£ï¼Œå…¶å®å°±æ˜¯æ‡’ï¼Œå°±æ˜¯å®… æ•´å¥½åœ¨ç†Ÿæ‚‰ä¸€æŠŠPythonçš„çˆ¬è™«æ¡†æ¶scrapyã€‚è¿™ç¯‡æ–‡ç« ä¸æ˜¯æ•™ç¨‹ï¼Œ åªæ˜¯æˆ‘åœ¨ç»ƒä¹ è¿‡ç¨‹ä¸­å‡ºç°çš„ä¸€äº›é—®é¢˜çš„è®°å½•ï¼Œ å¦‚æœä½ æƒ³å­¦ä¹ scrayæ¡†æ¶çš„è¯,è¯·ç§»æ­¥å…¶ä»–ç½‘ç«™æ–‡ç« .æˆ–è€…ç›´æ¥æŸ¥çœ‹scrapyå®˜æ–¹æ–‡æ¡£.">
<meta name="keywords" content="python,scrapy">
<meta property="og:type" content="blog">
<meta property="og:title" content="ç»ƒä¹ ä½¿ç”¨scrapyæ¡†æ¶æŠ“å–å›¾è™«å›¾ç‰‡">
<meta property="og:url" content="http://xuyoze.github.io/2018/01/01/using-scrapy/index.html">
<meta property="og:site_name" content="ç¨‹åºå‘˜çš„åšå®¢">
<meta property="og:description" content="å…ƒæ—¦å‡æœŸï¼Œå¤©å¹²ç‰©ç‡¥ï¼Œå¯’é£åˆºéª¨ï¼Œä¸å®œå¤–å‡ºã€‚é»„å†ä¸Šå¥½åƒæ˜¯è¿™ä¹ˆè¯´çš„ï¼Œå—¯ï¼Œ å‡†æ²¡é”™ã€‚ æ‰€ä»¥åœ¨å®¶ä¸‰å¤©ä¸å‡ºå±‹ã€‚ã€‚ã€‚ã€‚ ä»¥ä¸Šéƒ½æ˜¯å€Ÿå£ï¼Œå…¶å®å°±æ˜¯æ‡’ï¼Œå°±æ˜¯å®… æ•´å¥½åœ¨ç†Ÿæ‚‰ä¸€æŠŠPythonçš„çˆ¬è™«æ¡†æ¶scrapyã€‚è¿™ç¯‡æ–‡ç« ä¸æ˜¯æ•™ç¨‹ï¼Œ åªæ˜¯æˆ‘åœ¨ç»ƒä¹ è¿‡ç¨‹ä¸­å‡ºç°çš„ä¸€äº›é—®é¢˜çš„è®°å½•ï¼Œ å¦‚æœä½ æƒ³å­¦ä¹ scrayæ¡†æ¶çš„è¯,è¯·ç§»æ­¥å…¶ä»–ç½‘ç«™æ–‡ç« .æˆ–è€…ç›´æ¥æŸ¥çœ‹scrapyå®˜æ–¹æ–‡æ¡£.">
<meta property="og:locale" content="zh-cn">
<meta property="og:image" content="http://xuyoze.github.io/2018/01/01/using-scrapy/01.jpg">
<meta property="og:image" content="http://xuyoze.github.io/2018/01/01/using-scrapy/02.jpg">
<meta property="og:updated_time" content="2018-01-04T09:05:52.131Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ç»ƒä¹ ä½¿ç”¨scrapyæ¡†æ¶æŠ“å–å›¾è™«å›¾ç‰‡">
<meta name="twitter:description" content="å…ƒæ—¦å‡æœŸï¼Œå¤©å¹²ç‰©ç‡¥ï¼Œå¯’é£åˆºéª¨ï¼Œä¸å®œå¤–å‡ºã€‚é»„å†ä¸Šå¥½åƒæ˜¯è¿™ä¹ˆè¯´çš„ï¼Œå—¯ï¼Œ å‡†æ²¡é”™ã€‚ æ‰€ä»¥åœ¨å®¶ä¸‰å¤©ä¸å‡ºå±‹ã€‚ã€‚ã€‚ã€‚ ä»¥ä¸Šéƒ½æ˜¯å€Ÿå£ï¼Œå…¶å®å°±æ˜¯æ‡’ï¼Œå°±æ˜¯å®… æ•´å¥½åœ¨ç†Ÿæ‚‰ä¸€æŠŠPythonçš„çˆ¬è™«æ¡†æ¶scrapyã€‚è¿™ç¯‡æ–‡ç« ä¸æ˜¯æ•™ç¨‹ï¼Œ åªæ˜¯æˆ‘åœ¨ç»ƒä¹ è¿‡ç¨‹ä¸­å‡ºç°çš„ä¸€äº›é—®é¢˜çš„è®°å½•ï¼Œ å¦‚æœä½ æƒ³å­¦ä¹ scrayæ¡†æ¶çš„è¯,è¯·ç§»æ­¥å…¶ä»–ç½‘ç«™æ–‡ç« .æˆ–è€…ç›´æ¥æŸ¥çœ‹scrapyå®˜æ–¹æ–‡æ¡£.">
<meta name="twitter:image" content="http://xuyoze.github.io/2018/01/01/using-scrapy/01.jpg">
<meta name="twitter:creator" content="@yoze">
    
    
        
    
    
        <meta property="og:image" content="http://xuyoze.github.io/assets/images/avator.png"/>
    
    
        <meta property="og:image" content="http://xuyoze.github.io/2018/01/01/using-scrapy/32615134.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://xuyoze.github.io/2018/01/01/using-scrapy/32615134.jpg" />
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-1udptkpril81ozu8ifd8zpujn7ipu7lefxsiu5gxx0dpnzntdx6dusvki3ao.min.css">
    <!--STYLES END-->
    
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-111753291-1', 'auto');
        ga('send', 'pageview');
    </script>


    
    <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?d484c06aa1636ad18eeb208942d6f840";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">ç¨‹åºå‘˜çš„åšå®¢</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="/assets/images/avator.png" alt="ä½œè€…çš„å›¾ç‰‡"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/avator.png" alt="ä½œè€…çš„å›¾ç‰‡"/>
                </a>
                <h4 class="sidebar-profile-name">Yoze</h4>
                
                    <h5 class="sidebar-profile-bio"><p>[æŠ–è…¿æ‚£è€…] [è½»åº¦å¼ºè¿«ç—‡] [é“å¾·è´¥å] [æ·±äº•å†°] [æ“…æ’¸ç ] [å–œçœ‹å‰§] [æˆ¿å¥´]</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="é¦–é¡µ"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">é¦–é¡µ</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="åˆ†ç±»"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">åˆ†ç±»</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="æ ‡ç­¾"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">æ ‡ç­¾</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="å½’æ¡£"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">å½’æ¡£</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                            title="å…³äº"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">å…³äº</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/xuyoze" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            ç»ƒä¹ ä½¿ç”¨scrapyæ¡†æ¶æŠ“å–å›¾è™«å›¾ç‰‡
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2018-01-01T21:14:58+08:00">
	
		    1æœˆ 01, 2018
    	
    </time>
    
        <span>å‘å¸ƒåœ¨ </span>
        
    <a class="category-link" href="/categories/programming/">ç¼–ç¨‹</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>å…ƒæ—¦å‡æœŸï¼Œå¤©å¹²ç‰©ç‡¥ï¼Œå¯’é£åˆºéª¨ï¼Œä¸å®œå¤–å‡ºã€‚é»„å†ä¸Šå¥½åƒæ˜¯è¿™ä¹ˆè¯´çš„ï¼Œå—¯ï¼Œ å‡†æ²¡é”™ã€‚</p>
<p>æ‰€ä»¥åœ¨å®¶ä¸‰å¤©ä¸å‡ºå±‹ã€‚ã€‚ã€‚ã€‚</p>
<p><em>ä»¥ä¸Šéƒ½æ˜¯å€Ÿå£ï¼Œå…¶å®å°±æ˜¯æ‡’ï¼Œå°±æ˜¯å®…</em></p>
<p>æ•´å¥½åœ¨ç†Ÿæ‚‰ä¸€æŠŠ<code>Python</code>çš„çˆ¬è™«æ¡†æ¶<code>scrapy</code>ã€‚è¿™ç¯‡æ–‡ç« ä¸æ˜¯æ•™ç¨‹ï¼Œ åªæ˜¯æˆ‘åœ¨ç»ƒä¹ è¿‡ç¨‹ä¸­å‡ºç°çš„ä¸€äº›é—®é¢˜çš„è®°å½•ï¼Œ å¦‚æœä½ æƒ³å­¦ä¹ <code>scray</code>æ¡†æ¶çš„è¯,è¯·ç§»æ­¥å…¶ä»–ç½‘ç«™æ–‡ç« .æˆ–è€…ç›´æ¥æŸ¥çœ‹scrapyå®˜æ–¹æ–‡æ¡£.<br><a id="more"></a></p>
<h1 id="table-of-contents">ç›®å½•</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#çˆ¬å–å‰å‡†å¤‡"><span class="toc-text">çˆ¬å–å‰å‡†å¤‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#çˆ¬å»å…¥å£"><span class="toc-text">çˆ¬å»å…¥å£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åŸå›¾åœ°å€åˆ†æ"><span class="toc-text">åŸå›¾åœ°å€åˆ†æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä»£ç ç¼–å†™"><span class="toc-text">ä»£ç ç¼–å†™</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ›å»ºçˆ¬è™«"><span class="toc-text">åˆ›å»ºçˆ¬è™«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ç›¸å…³ä»£ç ç¼–å†™"><span class="toc-text">ç›¸å…³ä»£ç ç¼–å†™</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ç›¸å…³é—®é¢˜"><span class="toc-text">ç›¸å…³é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¥å£è¯·æ±‚ä¸æˆåŠŸæˆ–è¿”å›çš„æ•°æ®ä¸ºç©º"><span class="toc-text">æ¥å£è¯·æ±‚ä¸æˆåŠŸæˆ–è¿”å›çš„æ•°æ®ä¸ºç©º</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æœ¬æœºæ²¡æœ‰å›¾ç‰‡å¤„ç†ç›¸å…³åº“"><span class="toc-text">æœ¬æœºæ²¡æœ‰å›¾ç‰‡å¤„ç†ç›¸å…³åº“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å…¶ä»–"><span class="toc-text">å…¶ä»–</span></a></li></ol>
<h2 id="çˆ¬å–å‰å‡†å¤‡"><a href="#çˆ¬å–å‰å‡†å¤‡" class="headerlink" title="çˆ¬å–å‰å‡†å¤‡"></a>çˆ¬å–å‰å‡†å¤‡</h2><p>å›¾è™«çš„ç›¸å…³å›¾ç‰‡éƒ½æ˜¯æŒ‰ç…§Tagçš„æ–¹å¼è¿›è¡Œç»„ç»‡çš„, æ‰€ä»¥æˆ‘ä»¬å¾ˆå®¹æ˜“å°±å¯ä»¥æ ¹æ®æ ‡ç­¾è¿›è¡ŒæŸç±»å›¾ç‰‡çš„çˆ¬å–ã€‚<br>ä¸‹é¢æ˜¯å›¾è™«çš„å…¥å£é¡µé¢<a href="https://tuchong.com/explore/" target="_blank" rel="noopener">å›¾è™«å…¥å£</a><br><img src="/2018/01/01/using-scrapy/01.jpg" title="listpage"></p>
<h3 id="çˆ¬å»å…¥å£"><a href="#çˆ¬å»å…¥å£" class="headerlink" title="çˆ¬å»å…¥å£"></a>çˆ¬å»å…¥å£</h3><p>æ¯ä¸ªæ ‡ç­¾æˆ–ä¸“é¢˜é¡µé¢é‡‡ç”¨çš„æ˜¯JSåŠ¨æ€ç¿»é¡µ,æˆ‘ä»¬å¯ä»¥é€šè¿‡WEBå·¥å…·çš„ç½‘ç»œåŠŸèƒ½,æˆ–è€…fidderæŸ¥çœ‹å¯¹åº”çš„è¯·æ±‚.<br>è·å¾—å¦‚ä¸‹æ¥å£è¯·æ±‚åœ°å€:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https://tuchong.com/rest/tags/%E8%87%AA%E7%84%B6/posts?page=1&amp;count=20&amp;type=hot</span><br></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°, æœ‰å‡ ä¸ªå¯ç”¨çš„å‚æ•°:</p>
<ul>
<li>tags</li>
<li>page</li>
<li>count</li>
<li>type</li>
</ul>
<p>ç”±æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°åˆ†é¡µçš„æ¥å£æ•°æ®å¦‚ä¸‹å›¾æ‰€ç¤ºè¿™ä¸ªæ˜¯åˆ—è¡¨é¡µçš„åŸºæœ¬æ•°æ®ä¿¡æ¯<br><img src="/2018/01/01/using-scrapy/02.jpg" title="listpage"></p>
<p>è¿”å›çš„JSONæ•°æ®ä¸­æ¯ä¸ªpostèŠ‚ç‚¹ä¸‹éƒ½æœ‰ä¸€ä¸ªimagesæ•°ç»„,å¦‚æœæ•°ç»„ä¸­æœ‰å¯¹ä¸ªå€¼è¡¨ç¤º,è¿™ä¸ªæ˜¯ä¸€ç»„å¥—å›¾.<br>å› æ­¤æˆ‘ä»¬å¯ä»¥æ ¹æ® images èŠ‚ç‚¹,å¾ªç¯å¹¶è·å–ç›¸åº”çš„å¥—å›¾ã€‚</p>
<h3 id="åŸå›¾åœ°å€åˆ†æ"><a href="#åŸå›¾åœ°å€åˆ†æ" class="headerlink" title="åŸå›¾åœ°å€åˆ†æ"></a>åŸå›¾åœ°å€åˆ†æ</h3><p>ç”±äºåˆ—è¡¨é¡µæ˜¯ç¼©æ”¾åçš„å›¾ç‰‡, æ‰€ä»¥æˆ‘ä»¬åªèƒ½æ‰‹åŠ¨æŸ¥çœ‹å¹¶å½’çº³åŸå›¾æ–‡ä»¶çš„è·¯å¾„è§„åˆ™.<br>ä¹Ÿè®¸å“ªä¸€å¤©è§„åˆ™å°±å˜äº†ä¹Ÿè¯´ä¸ä¸Šä½†æ˜¯ç›®å‰è¿˜æ˜¯å¯ç”¨çš„ã€‚</p>
<p>è§„åˆ™å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>ç¼©ç•¥å›¾<br>è§„åˆ™ :<code>https://photo.tuchong.com/</code>+ author_id + <code>/g/</code> + img_id +<code>.jpg</code>  å¦‚:<a href="https://photo.tuchong.com/1370833/g/20494979.jpg" target="_blank" rel="noopener">https://photo.tuchong.com/1370833/g/20494979.jpg</a><br><code>author_id</code> æ˜¯å›¾ç‰‡ä½œè€…çš„ç¼–å·,<code>img_id</code> æ˜¯å›¾ç‰‡ç¼–å·</p>
</li>
<li><p>åŸå›¾<br>è§„åˆ™ :<code>https://photo.tuchong.com/</code>+ author_id + <code>/f/</code> + img_id +<code>.jpg</code>  å¦‚:<a href="https://photo.tuchong.com/1370833/f/20494979.jpg" target="_blank" rel="noopener">https://photo.tuchong.com/1370833/f/20494979.jpg</a><br><code>author_id</code> æ˜¯å›¾ç‰‡ä½œè€…çš„ç¼–å·,<code>img_id</code> æ˜¯å›¾ç‰‡ç¼–å·</p>
</li>
</ul>
<h2 id="ä»£ç ç¼–å†™"><a href="#ä»£ç ç¼–å†™" class="headerlink" title="ä»£ç ç¼–å†™"></a>ä»£ç ç¼–å†™</h2><h3 id="åˆ›å»ºçˆ¬è™«"><a href="#åˆ›å»ºçˆ¬è™«" class="headerlink" title="åˆ›å»ºçˆ¬è™«"></a>åˆ›å»ºçˆ¬è™«</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºé¡¹ç›®</span></span><br><span class="line">scrapy startproject TuchongProj</span><br><span class="line"><span class="comment"># è¿›å…¥é¡¹ç›®</span></span><br><span class="line">cd TuchongProj</span><br><span class="line"><span class="comment"># åˆ›å»ºçˆ¬è™«</span></span><br><span class="line">scrapy genspider tuchong tuchong.com</span><br></pre></td></tr></table></figure>
<h3 id="ç›¸å…³ä»£ç ç¼–å†™"><a href="#ç›¸å…³ä»£ç ç¼–å†™" class="headerlink" title="ç›¸å…³ä»£ç ç¼–å†™"></a>ç›¸å…³ä»£ç ç¼–å†™</h3><p>tuchong.py æ¼”ç¤ºä»£ç , ä»£ç æœªå®ç°ç¿»é¡µ,åªå–äº†ä¸€é¡µæ•°æ®ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TuchongSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="string">'tuchong'</span></span><br><span class="line">    allowed_domains = [<span class="string">'tuchong.com'</span>]</span><br><span class="line">    <span class="comment"># è¯·æ±‚URLæ„é€ å‚æ•°</span></span><br><span class="line">    tag = <span class="string">"é£å…‰"</span></span><br><span class="line">    types = <span class="string">"hot"</span>  <span class="comment"># new</span></span><br><span class="line">    order = <span class="string">"weekly"</span></span><br><span class="line">    page = <span class="string">"1"</span></span><br><span class="line">    count = <span class="string">"20"</span></span><br><span class="line">    baseUrl = <span class="string">"https://tuchong.com/rest/tags/"</span></span><br><span class="line">    start_urls = [baseUrl + tag + <span class="string">"/posts?page="</span> +</span><br><span class="line">                  page + <span class="string">"&amp;count="</span> + count + <span class="string">"&amp;order="</span> + order]</span><br><span class="line">    <span class="comment"># æš‚æ—¶æœªåšåˆ†é¡µåŠŸèƒ½(å¾ªç¯page)</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        posts = json.loads(response.body)[<span class="string">'postList'</span>]</span><br><span class="line">        <span class="keyword">for</span> post <span class="keyword">in</span> posts:</span><br><span class="line">            images = post[<span class="string">'images'</span>]</span><br><span class="line">            <span class="keyword">for</span> img <span class="keyword">in</span> images:</span><br><span class="line">                item = TuchongprojItem()</span><br><span class="line">                author_id = img[<span class="string">'user_id'</span>]</span><br><span class="line">                img_id = img[<span class="string">'img_id'</span>]</span><br><span class="line">                img_link = <span class="string">"https://photo.tuchong.com/"</span> + \</span><br><span class="line">                    str(author_id) + <span class="string">"/f/"</span> + str(img_id) + <span class="string">".jpg"</span></span><br><span class="line">                item[<span class="string">'authorId'</span>] = author_id</span><br><span class="line">                item[<span class="string">'imageId'</span>] = img_id</span><br><span class="line">                item[<span class="string">'imageLink'</span>] = img_link</span><br><span class="line">                <span class="keyword">yield</span> item</span><br></pre></td></tr></table></figure>
<p>æˆ‘åœ¨å®šä¹‰çš„Itemæœ‰ä¸‰ä¸ªå­—æ®µï¼Œ è¿™é‡Œåªå–äº†æ¥å£JSONæ•°æ®ä¸­çš„author_idå’Œimg_id æŒ‰ç…§ä¸Šé¢çš„åˆ†æçš„è§„åˆ™,æ‹¼è£…äº†å›¾ç‰‡çš„å¤§å›¾è·¯å¾„ã€‚</p>
<p>Itemå®šä¹‰ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TuchongprojItem</span><span class="params">(scrapy.Item)</span>:</span></span><br><span class="line">    <span class="comment"># define the fields for your item here like:</span></span><br><span class="line">    authorId = scrapy.Field()</span><br><span class="line">    imageId = scrapy.Field()</span><br><span class="line">    imageLink = scrapy.Field()</span><br></pre></td></tr></table></figure></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯å®šä¹‰pipelineå¤„ç†ç›¸å…³æ•°æ®äº†<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TuchongprojPipeline</span><span class="params">(ImagesPipeline)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_media_requests</span><span class="params">(self, item, info)</span>:</span></span><br><span class="line">        imglink = item[<span class="string">'imageLink'</span>]</span><br><span class="line">        <span class="comment"># print(imglink)</span></span><br><span class="line">        <span class="keyword">yield</span> scrapy.Request(imglink)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">item_completed</span><span class="params">(self, result, item, info)</span>:</span></span><br><span class="line">        <span class="comment"># print(result)</span></span><br><span class="line">        <span class="comment"># [(True, &#123;'url': 'https://photo.tuchong.com/1660246/f/9281459.jpg', 'path': 'full/e8876e7547c166d58876c3fce547d6819d8bf031.jpg', 'checksum': 'd78e6ba1115ae956878bdc630173ea7a'&#125;)]</span></span><br><span class="line">        <span class="comment"># å–å‡ºå›¾ç‰‡å­˜æ”¾çš„åœ°å€</span></span><br><span class="line">        author_id = item[<span class="string">'authorId'</span>]</span><br><span class="line">        img_id = item[<span class="string">'imageId'</span>]</span><br><span class="line">        patharr = [x[<span class="string">"path"</span>] <span class="keyword">for</span> ok, x <span class="keyword">in</span> result <span class="keyword">if</span> ok]</span><br><span class="line">        path = patharr[<span class="number">0</span>]</span><br><span class="line">        <span class="comment"># æ–‡ä»¶é‡å‘½å(åŸåœ°å€,æ–°åœ°å€)</span></span><br><span class="line">        os.rename(images_store + path, images_store + <span class="string">"full/"</span> +</span><br><span class="line">                  str(author_id) + <span class="string">"-"</span> + str(img_id) + <span class="string">".jpg"</span>)</span><br><span class="line">        <span class="keyword">return</span> item</span><br></pre></td></tr></table></figure></p>
<p>ç”±äºè¦å¤„ç†å›¾ç‰‡æ•°æ®,æˆ‘ä»¬ä½¿ç”¨scrapyæä¾›<code>ImagesPipeline</code>è¿›è¡Œå›¾ç‰‡å¤„ç†.<br>é‡å†™<code>ImagesPipeline</code>é‡Œçš„ä¸¤ä¸ªæ–¹æ³•:<br><code>get_media_requests</code>æ–¹æ³•, ä¸»è¦è´Ÿè´£å‘é€å›¾ç‰‡è·å–è¯·æ±‚, è¿™é‡Œæˆ‘ä»¬å°†æˆ‘ä»¬æ‹¼è£…çš„å›¾ç‰‡å¤§å›¾åœ°å€ä¼ é€’ç»™<code>Request</code>è¿›è¡Œå›¾ç‰‡å¤„ç†.</p>
<p><code>item_completed</code>æ–¹æ³•, è¿™é‡Œä¸»è¦ç”¨æ¥å¯¹ä¸‹è½½å›æ¥çš„å›¾ç‰‡è¿›è¡Œé‡å‘½åå¤„ç†. æˆ‘ä»¬çš„å‘½åè§„åˆ™æ˜¯ <code>author_id+&#39;-&#39;+img_id</code>, è¿™æ ·ä¾¿äºæˆ‘ä»¬è¿›è¡Œæ’åº ^_^</p>
<p>ä½¿ç”¨<code>ImagesPipeline</code> æˆ‘ä»¬éœ€è¦åˆ¶å®šå›¾ç‰‡çš„å­˜æ”¾åœ°å€,åŒæ—¶æˆ‘ä»¬éœ€è¦å¯ç”¨å½“å‰pipeline</p>
<p>settings.py<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Configure item pipelines</span><br><span class="line"># See http://scrapy.readthedocs.org/en/latest/topics/item-pipeline.html</span><br><span class="line">ITEM_PIPELINES = &#123;</span><br><span class="line">    &apos;TuchongProj.pipelines.TuchongprojPipeline&apos;: 300,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># çˆ¬å–å›¾ç‰‡åå›¾ç‰‡å­˜æ”¾çš„ä½ç½®</span><br><span class="line">IMAGES_STORE = &quot;F:/_tuchong/fengjing/&quot;</span><br></pre></td></tr></table></figure></p>
<p>å¥½äº†, çˆ¬è™«å·®ä¸å¤šäº†,è¿è¡Œä¸‹è¯•è¯•å§!</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">scrapy crawl tuchong</span><br></pre></td></tr></table></figure>
<h2 id="ç›¸å…³é—®é¢˜"><a href="#ç›¸å…³é—®é¢˜" class="headerlink" title="ç›¸å…³é—®é¢˜"></a>ç›¸å…³é—®é¢˜</h2><h3 id="æ¥å£è¯·æ±‚ä¸æˆåŠŸæˆ–è¿”å›çš„æ•°æ®ä¸ºç©º"><a href="#æ¥å£è¯·æ±‚ä¸æˆåŠŸæˆ–è¿”å›çš„æ•°æ®ä¸ºç©º" class="headerlink" title="æ¥å£è¯·æ±‚ä¸æˆåŠŸæˆ–è¿”å›çš„æ•°æ®ä¸ºç©º"></a>æ¥å£è¯·æ±‚ä¸æˆåŠŸæˆ–è¿”å›çš„æ•°æ®ä¸ºç©º</h3><ul>
<li><p>UserAgenté—®é¢˜.<br>è‡ªå®šä¹‰UserAgent,åœ¨settings.pyä¿®æ”¹UA</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Crawl responsibly by identifying yourself (and your website) on the user-agent</span><br><span class="line">USER_AGENT = &apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3294.6 Safari/537.36&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¯·æ±‚è¿‡å¿«,ç›¸åº”ä¸è¿‡æ¥<br>é™åˆ¶å¹¶å‘æ•°,å¢åŠ å»¶è¿Ÿæ—¶é—´</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Configure maximum concurrent requests performed by Scrapy (default: 16)</span><br><span class="line">CONCURRENT_REQUESTS = 1</span><br><span class="line"></span><br><span class="line"># Configure a delay for requests for the same website (default: 0)</span><br><span class="line"># See http://scrapy.readthedocs.org/en/latest/topics/settings.html#download-delay</span><br><span class="line"># See also autothrottle settings and docs</span><br><span class="line">DOWNLOAD_DELAY = 5</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="æœ¬æœºæ²¡æœ‰å›¾ç‰‡å¤„ç†ç›¸å…³åº“"><a href="#æœ¬æœºæ²¡æœ‰å›¾ç‰‡å¤„ç†ç›¸å…³åº“" class="headerlink" title="æœ¬æœºæ²¡æœ‰å›¾ç‰‡å¤„ç†ç›¸å…³åº“"></a>æœ¬æœºæ²¡æœ‰å›¾ç‰‡å¤„ç†ç›¸å…³åº“</h3><div class="alert danger"><p>No module named â€˜PILâ€™</p>
</div>
<p>å®‰è£…Pillowåº“<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install pillow</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014320027235877860c87af5544f25a8deeb55141d60c5000" target="_blank" rel="noopener">pillowåŸºæœ¬çŸ¥è¯†</a></p>
<h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>è‡ªå·±å†™çˆ¬è™«,çº¯ç²¹å°±æ˜¯ç©ç¥¨ã€‚<br>æˆ‘ä»¬è‡ªå·±å†™çˆ¬è™«ï¼Œå»çˆ¬å–åˆ«äººçš„æ•°æ®ï¼Œ å°½é‡å°†å¹¶å‘é™ä½ï¼Œä¸è¦ç»™ç«™ç‚¹é€ æˆéªšæ‰°ã€‚<br>å¦‚æœå¯ä»¥å°½é‡æŒ‰ç…§çˆ¬è™«åè®®æ¥çˆ¬å–åº”å…çš„å†…å®¹ã€‚</p>
<p>é™„ å›¾è™«çš„çˆ¬è™«åè®®<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Robots.txt file from http://www.tuchong.com</span><br><span class="line"># All robots will spider the domain</span><br><span class="line"></span><br><span class="line">User-agent: YandexBot</span><br><span class="line">Disallow: /</span><br><span class="line">User-agent: MJ12bot</span><br><span class="line">Disallow: /</span><br><span class="line">User-agent: Purebot</span><br><span class="line">Disallow: /</span><br><span class="line">User-agent: psbot</span><br><span class="line">Disallow: /</span><br><span class="line"></span><br><span class="line">User-agent: *</span><br><span class="line">Disallow: /admin/</span><br><span class="line">Disallow: /api/</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p> ç›¸å…³å­¦ä¹ èµ„æ–™</p>
<ul>
<li><a href="http://scrapy-chs.readthedocs.io/zh_CN/1.0/intro/tutorial.html" target="_blank" rel="noopener">scrapyæ–‡æ¡£(CN)</a></li>
</ul>
</blockquote>

            

        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">æ ‡ç­¾</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/python/">python</a> <a class="tag tag--primary tag--small t-link" href="/tags/scrapy/">scrapy</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/01/04/centos-intall-nginx/" data-tooltip="CentOS å®‰è£…Nginxæ­¥éª¤" aria-label="ä¸Šä¸€ç¯‡: CentOS å®‰è£…Nginxæ­¥éª¤">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">ä¸Šä¸€ç¯‡</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/12/31/the-last-days-of-2017/" data-tooltip="å†™åœ¨2017å¹´çš„æœ€åå‡ å¤©" aria-label="ä¸‹ä¸€ç¯‡: å†™åœ¨2017å¹´çš„æœ€åå‡ å¤©">
                
                    <span class="hide-xs hide-sm text-small icon-mr">ä¸‹ä¸€ç¯‡</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://xuyoze.github.io/2018/01/01/using-scrapy/" title="åˆ†äº«åˆ° Twitter">
                    <i class="fa fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a class="post-action-btn btn btn--default" href="#disqus_thread">
                        <i class="fa fa-comment-o"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="ç›®å½•">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Powerd by
        <a href='https://hexo.io/'>Hexo</a>. Theme-
        <a href="https://github.com/LouisBarranqueiro/hexo-theme-tranquilpeak">Tranquilpeak</a>
       | Copyrights &copy;
        2018. Post with ğŸ’™ by
            Yoze.
    </span>
    <br/>
    <span>

    </span>
</footer>
            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/01/04/centos-intall-nginx/" data-tooltip="CentOS å®‰è£…Nginxæ­¥éª¤" aria-label="ä¸Šä¸€ç¯‡: CentOS å®‰è£…Nginxæ­¥éª¤">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">ä¸Šä¸€ç¯‡</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/12/31/the-last-days-of-2017/" data-tooltip="å†™åœ¨2017å¹´çš„æœ€åå‡ å¤©" aria-label="ä¸‹ä¸€ç¯‡: å†™åœ¨2017å¹´çš„æœ€åå‡ å¤©">
                
                    <span class="hide-xs hide-sm text-small icon-mr">ä¸‹ä¸€ç¯‡</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://xuyoze.github.io/2018/01/01/using-scrapy/" title="åˆ†äº«åˆ° Twitter">
                    <i class="fa fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a class="post-action-btn btn btn--default" href="#disqus_thread">
                        <i class="fa fa-comment-o"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="ç›®å½•">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="4">
    <i id="btn-close-shareoptions" class="fa fa-close"></i>
    <ul class="share-options">
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://xuyoze.github.io/2018/01/01/using-scrapy/">
                    <i class="fa fa-twitter" aria-hidden="true"></i><span>åˆ†äº«åˆ° Twitter</span>
                </a>
            </li>
        
    </ul>
</div>

            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avator.png" alt="ä½œè€…çš„å›¾ç‰‡"/>
        
            <h4 id="about-card-name">Yoze</h4>
        
            <div id="about-card-bio"><p>[æŠ–è…¿æ‚£è€…] [è½»åº¦å¼ºè¿«ç—‡] [é“å¾·è´¥å] [æ·±äº•å†°] [æ“…æ’¸ç ] [å–œçœ‹å‰§] [æˆ¿å¥´]</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>å“’å“’å“’</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                Mars
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-yhuo2grt8r7qkqumzgjoglkfbicl1thukjgmla6jopu56zpcowfedi5zjcor.min.js"></script>
<!--SCRIPTS END-->

    
        <script>
             var disqus_config = function () {
                 this.page.url = 'http://xuyoze.github.io/2018/01/01/using-scrapy/';
                 
                    this.page.identifier = '2018/01/01/using-scrapy/';
                 
             };
            (function() {
                var d = document, s = d.createElement('script');
                var disqus_shortname = 'yoze';
                s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
    



    </body>
</html>
